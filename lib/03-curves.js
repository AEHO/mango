webpackJsonp([2],[function(t,e,i){"use strict";i(75),i(77),i(83),i(84)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";var r=i(34)["default"],s=i(37)["default"],o=i(3)["default"],n=i(8)["default"],a=i(1)["default"];Object.defineProperty(e,"__esModule",{value:!0});var u=i(64),l=a(u),c=i(43),d=function(t){function e(){var t=void 0===arguments[0]?-1:arguments[0],i=void 0===arguments[1]?1:arguments[1],r=void 0===arguments[2]?-1:arguments[2],o=void 0===arguments[3]?1:arguments[3],a=void 0===arguments[4]?0:arguments[4],u=void 0===arguments[5]?100:arguments[5],l=void 0===arguments[6]?1:arguments[6];n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this._left=t,this._right=i,this._top=o,this._bottom=r,this._near=a,this._far=u,this._ar=l}return r(e,t),o(e,[{key:"_updateProjectionViewMatrix",value:function(){c.mat4.lookAt(this._viewMatrix,this._position,this._at,this._up),c.mat4.ortho(this._projectionMatrix,this._left*this._ar,this._right*this._ar,this._bottom,this._top,this._near,this._far),c.mat4.multiply(this._projectionViewMatrix,this._projectionMatrix,this._viewMatrix)}}]),e}(l["default"]);e["default"]=d,t.exports=e["default"]},,function(t,e,i){"use strict";var r=i(3)["default"],s=i(8)["default"];Object.defineProperty(e,"__esModule",{value:!0});var o=i(43),n=function(){function t(e){var i=void 0===arguments[1]?1:arguments[1],r=void 0===arguments[2]?!1:arguments[2];s(this,t),this.radius=i,this._camera=e,this._strict=r,this._currRot=o.quat.create(),this._lastRot=o.quat.create(),this._rot=o.quat.create(),this._startVec=o.vec3.create(),this._endVec=o.vec3.create()}return r(t,[{key:"start",value:function(t){this._toSphere(this._startVec,t),this._currRot=o.quat.clone(this._lastRot)}},{key:"stop",value:function(t){this._strict?o.quat.multiply(this._lastRot,this._lastRot,this._currRot):o.quat.multiply(this._lastRot,this._currRot,this._lastRot)}},{key:"move",value:function(t){this._toSphere(this._endVec,t),o.quat.rotationTo(this._currRot,this._startVec,this._endVec),this._strict?o.quat.multiply(this._rot,this._lastRot,this._currRot):o.quat.multiply(this._rot,this._currRot,this._lastRot)}},{key:"_toSphere",value:function(t,e){t[0]=2*e.offsetX/this._camera._width-1,t[1]=1-2*e.offsetY/this._camera._height;var i=t[0]*t[0]+t[1]*t[1],r=this.radius*this.radius;i>r?t[2]=0:t[2]=Math.sqrt(r-i),o.vec3.normalize(t,t)}},{key:"rotation",get:function(){return this._rot}}]),t}();e["default"]=n,t.exports=e["default"]},function(t,e,i){"use strict";var r=i(8)["default"],s=i(1)["default"];Object.defineProperty(e,"__esModule",{value:!0});var o=i(55),n=(s(o),function a(t,e){r(this,a),this.coords=new Float32Array([t[0],t[1],t[2],e[0],e[1],e[2]]),this.indices=new Uint16Array([0,1])});e["default"]=n,t.exports=e["default"]},,,function(t,e,i){"use strict";var r=i(8)["default"],s=i(1)["default"];Object.defineProperty(e,"__esModule",{value:!0});var o=i(55),n=(s(o),function a(){var t=void 0===arguments[0]?2:arguments[0];r(this,a);var e=8*t+4;this.coords=new Float32Array(3*e),this.indices=new Uint16Array(e);for(var i=0,s=0,o=-t;t>=o;o++)this.coords[i]=o,this.coords[i+1]=-t,this.coords[i+2]=0,this.indices[s]=s++,this.coords[i+3]=o,this.coords[i+4]=t,this.coords[i+5]=0,this.indices[s]=s++,this.coords[i+6]=-t,this.coords[i+7]=o,this.coords[i+8]=0,this.indices[s]=s++,this.coords[i+9]=t,this.coords[i+10]=o,this.coords[i+11]=0,this.indices[s]=s++,i+=12});e["default"]=n,t.exports=e["default"]},function(t,e,i){"use strict";var r=i(3)["default"],s=i(8)["default"],o=i(1)["default"];Object.defineProperty(e,"__esModule",{value:!0});var n=i(71),a=o(n),u=function(){function t(e,i){s(this,t),i||(i={ambient:[.5,.5,.5,1],diffuse:[.5,.5,.5,1],specular:[.5,.5,.5,1]}),this.shader=new a["default"](e,i),this.componentCount=6}return r(t,[{key:"prepare",value:function(t){this.shader.prepare(t)}}]),t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";var r=i(34)["default"],s=i(37)["default"],o=i(3)["default"],n=i(8)["default"],a=i(1)["default"];Object.defineProperty(e,"__esModule",{value:!0});var u=i(72),l=a(u),c=i(73),d=a(c),h=i(61),f=a(h),_=6,v=(new Float32Array).BYTES_PER_ELEMENT,m=v*_,p={vertex:0,normal:v*_/2},g=function(t){function e(t,i){n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this._OFFSETS=p,this._STRIDE_SIZE=m,this._STRIDE=_,this._gl=t,this.ambient=new Float32Array(i.ambient),this.diffuse=new Float32Array(i.diffuse),this.specular=new Float32Array(i.specular),this.init(l["default"],d["default"],["a_Position","a_Normal","u_matAmb","u_matDif","u_matSpec","u_NormalMatrix","u_ModelMatrix","u_ProjectionViewMatrix"])}return r(e,t),o(e,[{key:"prepare",value:function(t){for(var e=2*t.coords.length,i=new Float32Array(e),r=0,s=0;e>s;s+=_)i[s]=t.coords[r],i[s+1]=t.coords[r+1],i[s+2]=t.coords[r+2],i[s+3]=t.normals[r],i[s+4]=t.normals[r+1],i[s+5]=t.normals[r+2],r+=3;return i}},{key:"prepareUniforms",value:function(t,e){this.setUniformMatrix4fv("u_ModelMatrix",t.modelMatrix),this.setUniformMatrix4fv("u_NormalMatrix",t.normalMatrix),this.setUniformMatrix4fv("u_ProjectionViewMatrix",e.projectionViewMatrix),this.setUniform4fv("u_matAmb",this.ambient),this.setUniform4fv("u_matDif",this.diffuse),this.setUniform4fv("u_matSpec",this.specular)}},{key:"prepareLocations",value:function(t){this._gl.vertexAttribPointer(this._locations.a_Position,t.componentCount/2,this._gl.FLOAT,!1,m,p.vertex),this._gl.vertexAttribPointer(this._locations.a_Normal,t.componentCount/2,this._gl.FLOAT,!1,m,p.normal),this._gl.enableVertexAttribArray(this._locations.a_Position),this._gl.enableVertexAttribArray(this._locations.a_Normal)}}]),e}(f["default"]);e["default"]=g,t.exports=e["default"]},function(t,e){t.exports="attribute vec4 a_Position;\nattribute vec4 a_Normal;\n\nuniform mat4 u_NormalMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_ProjectionViewMatrix;\n\nvarying vec4 v_Normal;\nvarying vec4 v_Position;\n\nvoid main ()\n{\n  v_Position = -vec4(u_ModelMatrix * a_Position);\n  v_Normal = normalize(vec4(u_NormalMatrix * a_Normal));\n\n  gl_Position = u_ProjectionViewMatrix * u_ModelMatrix * a_Position;\n  gl_PointSize = 4.0;\n}\n\n"},function(t,e){t.exports="/* Phong per-frag shader */\n\nprecision mediump float;\n\nuniform vec4 u_matAmb;\nuniform vec4 u_matDif;\nuniform vec4 u_matSpec;\n\nconst float shininess = 100.0;\n\nvec4 lightPosition = vec4(0.0, 2.0, -3.0, 0.0);\nvec4 lightAmbient = vec4(0.2, 0.2, 0.2, 1.0);\nvec4 lightDiffuse = vec4(0.8, 0.8, 0.8, 1.0);\nvec4 lightSpecular = vec4(0.8, 0.9, 0.8, 1.0);\n\nvarying vec4 v_Normal;\nvarying vec4 v_Position;\n\nvoid main ()\n{\n  vec4 L = normalize(lightPosition - v_Position);\n  vec4 V = normalize(v_Position);\n  vec4 H = normalize(L + V);\n\n  float Kd = max(dot(v_Normal,L), 0.0);\n  float Ks = pow(max(dot(v_Normal,H), 0.0), shininess);\n\n  vec4 diffuse = Kd * lightDiffuse * u_matDif;\n  vec4 specular = Ks * lightSpecular * u_matSpec;\n  vec4 ambient = lightAmbient * u_matAmb;\n\n  gl_FragColor = vec4(ambient + diffuse + specular);\n}\n\n"},function(t,e,i){"use strict";var r=i(34)["default"],s=i(37)["default"],o=i(3)["default"],n=i(8)["default"],a=i(1)["default"];Object.defineProperty(e,"__esModule",{value:!0});var u=i(64),l=a(u),c=i(43),d=function(t){return t*Math.PI/180},h=function(t){function e(){var t=void 0===arguments[0]?70:arguments[0],i=void 0===arguments[1]?.1:arguments[1],r=void 0===arguments[2]?1e3:arguments[2];void 0===arguments[3]?1:arguments[3];n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this._fov=t,this._near=i,this._far=r,this._ar=1}return r(e,t),o(e,[{key:"_updateProjectionViewMatrix",value:function(){c.mat4.lookAt(this._viewMatrix,this._position,this._at,this._up),c.mat4.perspective(this._projectionMatrix,d(this._fov),this._ar,this._near,this._far),c.mat4.multiply(this._projectionViewMatrix,this._projectionMatrix,this._viewMatrix)}},{key:"fov",get:function(){return this._fov},set:function(t){this._fov=t,this._dirty=!0,this._dirtyInverse=!0}}]),e}(l["default"]);e["default"]=h,t.exports=e["default"]},function(t,e,i){"use strict";var r=i(27)["default"],s=i(1)["default"];Object.defineProperty(e,"__esModule",{value:!0});var o=(i(43),i(76)),n=s(o),a=["open","closed"],u={open:{bMode:document.querySelector(".widget-open.b-mode"),bClear:document.querySelector(".widget-open.b-clear"),curveType:document.querySelector(".widget-open.curve-type"),iterationsValue:document.querySelector(".widget-open.iterations span"),iterationsRange:document.querySelector(".widget-open.iterations input"),degree:document.querySelector(".widget-open.degree"),degreeRange:document.querySelector(".widget-open.degree input"),degreeValue:document.querySelector(".widget-open.degree span"),variance:document.querySelector(".widget-open.variance"),varianceRange:document.querySelector(".widget-open.variance input"),varianceValue:document.querySelector(".widget-open.variance span")},closed:{bMode:document.querySelector(".widget-closed.b-mode"),bClear:document.querySelector(".widget-closed.b-clear"),curveType:document.querySelector(".widget-closed.curve-type"),iterationsValue:document.querySelector(".widget-closed.iterations span"),iterationsRange:document.querySelector(".widget-closed.iterations input"),degree:document.querySelector(".widget-closed.degree"),degreeRange:document.querySelector(".widget-closed.degree input"),degreeValue:document.querySelector(".widget-closed.degree span"),variance:document.querySelector(".widget-closed.variance"),varianceRange:document.querySelector(".widget-closed.variance input"),varianceValue:document.querySelector(".widget-closed.variance span")}},l=!0,c=!1,d=void 0;try{for(var h,f=function(){var t=h.value;u[t].bMode.addEventListener("click",function(e){(n["default"].curves[t].edit^=1)?e.target.textContent="INSERT":e.target.textContent="EDIT"}),u[t].bClear.addEventListener("click",function(e){n["default"].curves[t].current.clear(),n["default"].notify("curveSize")}),u[t].curveType.addEventListener("change",function(e){var i=n["default"].curves[t].current.points.control,r=n["default"].curves[t].current._offset;switch(e.target.value){case"rag":u[t].degree.classList.toggle("hidden"),u[t].variance.classList.toggle("hidden"),n["default"].curves[t].current=n["default"].curves[t].rags;break;case"nurbs":u[t].degree.classList.toggle("hidden"),u[t].variance.classList.toggle("hidden"),u[t].degreeValue.textContent=n["default"].curves[t].nurbs._degree,n["default"].curves[t].current=n["default"].curves[t].nurbs;break;default:throw new Error("Unrecognized curve type selected.")}n["default"].curves[t].current.setControlPoints(i,r),n["default"].notify("curvesChanged"),n["default"].notify(t)}),u[t].varianceRange.addEventListener("input",function(e){u[t].varianceValue.textContent=e.target.value,n["default"].curves[t].rags.variance=+e.target.value,n["default"].notify(t)}),u[t].degreeRange.addEventListener("input",function(e){u[t].degreeValue.textContent=e.target.value,n["default"].curves[t].nurbs.degree=+e.target.value,n["default"].notify(t)}),u[t].iterationsRange.addEventListener("input",function(e){u[t].iterationsValue.textContent=e.target.value,n["default"].curves[t].current.iterations=e.target.value,n["default"].notify("curveSize")})},_=r(a);!(l=(h=_.next()).done);l=!0)f()}catch(v){c=!0,d=v}finally{try{!l&&_["return"]&&_["return"]()}finally{if(c)throw d}}e["default"]=u,t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={open:{current:null,rags:null,nurbs:null,edit:!0},closed:{current:null,rags:null,nurbs:null,edit:!0},view:null,listeners:[]},r={open:[],closed:[],curveSize:[],curvesChanged:[]},s=function(t,e){r[t].push(e)},o=function(t){r[t].forEach(function(t){return t.call()})},n={curves:i,register:s,notify:o};e["default"]=n,t.exports=e["default"]},function(t,e,i){"use strict";function r(){C.update(),N.flush(),F.current.render()}var s=i(1)["default"],o=i(43),n=i(76),a=s(n),u=i(2),l=s(u),c=i(80),d=s(c),h=i(82),f=s(h),_=i(62),v=s(_),m=i(78),p=(s(m),i(63)),g=s(p),y=i(69),w=s(y),M=i(33),b=s(M),P=i(57),x=s(P),k=i(66),A=s(k),S=i(75),R=s(S),C=new l["default"](document.querySelector("#canvas-open"),{clearColor:[0,.1,0,1]}),j=new g["default"],N=new v["default"](j);j.position=[0,0,1],C.camera=j;var V=new b["default"](C._gl,{geometry:new w["default"](25),material:new x["default"](C._gl,[.3,.3,.3]),drawMode:"LINES"});V.position=[0,0,-1],V.scale=[.1,.1,.1];var E=new b["default"](C._gl,{geometry:new A["default"]([-1,0,0],[1,0,.2]),material:new x["default"](C._gl,[1,0,0]),drawMode:"LINES"}),O=new b["default"](C._gl,{geometry:new A["default"]([0,-1,0],[0,1,.2]),material:new x["default"](C._gl,[0,1,0]),drawMode:"LINES"}),F=a["default"].curves.open;F.rags=new f["default"](C._gl,j,new Float32Array([-.5,-.25,0,0,.25,0,.5,-.25,0])),F.nurbs=new d["default"](C._gl,j,new Float32Array([-.5,-.25,0,0,.25,0,.5,-.25,0]));var q=o.vec3.create(),L=-1;C.bindControls({onMouseDown:function(t){return q=o.vec3.create(),j.unproject(t,q),F.edit?void(L=F.current.intersectsControlPoint(q)):(F.current.addControlPoint(q),R["default"].open.degreeRange.max=F.current._offset/3,void a["default"].notify("open"))},onMouseMove:function(t){0>L||!F.edit||(j.unproject(t,q),F.current.updateControlPoint(L,q),~L&&a["default"].notify("open"))},onMouseUp:function(t){F.edit&&(0>L||(j.unproject(t,q),F.current.updateControlPoint(L,q),L=-1,r()))}}),a["default"].register("open",r),a["default"].register("curveSize",r),F.current=F.rags,N.submit(V,E,O),window.addEventListener("resize",r),r()},function(t,e,i){"use strict";var r=i(3)["default"],s=i(8)["default"],o=i(27)["default"],n=i(1)["default"];Object.defineProperty(e,"__esModule",{value:!0});var a=i(79),u=n(a),l=i(43),c=function(){function t(e,i,r){s(this,t),this._gl=e,this._drawModes=r||[e.POINTS,e.LINE_STRIP],this._dynVbo=new u["default"](e,i.componentCount),this._shader=i.shader,this._modelMatrix=l.mat4.create(),this._material=i}return r(t,[{key:"submit",value:function(t){this._dynVbo.bind(),this._dynVbo.push(this._shader.prepare(t))}},{key:"update",value:function(t,e){this._dynVbo.bind(),this._dynVbo.update(t,this._shader.prepare(e))}},{key:"reset",value:function(t){this._dynVbo.bind(),this._dynVbo.reset(this._shader.prepare(t))}},{key:"flush",value:function(t,e,i){if(this._dynVbo.count){this._shader.enable(),this._dynVbo.bind(),this._shader.prepareLocations(this._dynVbo),this._shader.prepareUniforms({modelMatrix:e||this._modelMatrix,normalMatrix:i||this._modelMatrix},t);var r=!0,s=!1,n=void 0;try{for(var a,u=o(this._drawModes);!(r=(a=u.next()).done);r=!0){var l=a.value;this._gl.drawArrays(l,0,this._dynVbo.count)}}catch(c){s=!0,n=c}finally{try{!r&&u["return"]&&u["return"]()}finally{if(s)throw n}}}}}]),t}();e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";var r=i(34)["default"],s=i(37)["default"],o=i(3)["default"],n=i(8)["default"],a=i(1)["default"];Object.defineProperty(e,"__esModule",{value:!0});var u=i(54),l=a(u),c=(new Float32Array).BYTES_PER_ELEMENT,d=30,h=function(t){function e(t){var i=void 0===arguments[1]?3:arguments[1],r=void 0===arguments[2]?[]:arguments[2];if(n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.componentCount=i,this._maxSize=d*i,this._buffer=t.createBuffer(),this._target=t.ARRAY_BUFFER,this._data=new Float32Array(this._maxSize),!this._buffer)throw new Error("DynamicBuffer: error while allocating buffer");t.bindBuffer(this._target,this._buffer),this.reset(r)}return r(e,t),o(e,[{key:"_realloc",value:function(t){for(this._maxSize=0;this._maxSize<t;)this._maxSize+=d;var e=new Float32Array(this._maxSize);e.set(this._data,0),this._data=e,this._gl.bufferData(this._target,this._maxSize*c,this._gl.DYNAMIC_DRAW),this._gl.bufferSubData(this._target,0,this._data)}},{key:"push",value:function(t){this._last+t.length>this._maxSize&&this._realloc(this._last+t.length),this._data.set(t,this._last),this._gl.bufferSubData(this._target,this._last*c,t),this._last+=t.length,this.count+=t.length/this.componentCount}},{key:"update",value:function(t,e){var i=this.componentCount*t;this._data.set(e,i),this._gl.bufferSubData(this._target,i*c,e)}},{key:"reset",value:function(t){return this._last=t.length,this.count=t.length/this.componentCount,t&&t.length?(this._data=t,this._maxSize=t.length,void this._gl.bufferData(this._target,t,this._gl.DYNAMIC_DRAW)):void this._gl.bufferData(this._target,this._maxSize*c,this._gl.DYNAMIC_DRAW)}}]),e}(l["default"]);e["default"]=h,t.exports=e["default"]},function(t,e,i){"use strict";var r=i(34)["default"],s=i(37)["default"],o=i(3)["default"],n=i(8)["default"],a=i(1)["default"];Object.defineProperty(e,"__esModule",{value:!0});var u=i(81),l=a(u),c=function(t){function e(t,i){var r=void 0===arguments[2]?[]:arguments[2],o=void 0===arguments[3]?20:arguments[3],a=void 0===arguments[4]?!0:arguments[4];n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,i,r,o),this._interpolateEndPoints=a,this._weights=[],this._knots=[],this._degree=0,this._dirtyKnots=!0,r.length&&this._init(r)}return r(e,t),o(e,[{key:"clear",value:function(){this._offset=0,this.points.curve=new Float32Array(3*this._iterations+3),this._degree=0,this._resetControlRenderer(),this._resetCurveRenderer()}},{key:"_reset",value:function(t,e){var i=e/3;this._offset=e,this._dirtyKnots=!0,this._weights=[];for(var r=0;r<this._offset/3;r++)this._weights.push(1);i>3?this._degree=3:this._degree=i-1,this.points.control=t,this._resetControlRenderer(),this._resetCurveRenderer()}},{key:"_init",value:function(t){this._appendToControlRenderer(t);var e=this._offset/3;e>3?this._degree=3:this._degree=e-1;for(var i=0;e>i;i++)this._weights.push(1);this._resetCurveRenderer()}},{key:"addControlPoint",value:function(t){this._degree||(this._degree=1),this._dirtyKnots=!0,this._appendToControlRenderer(t),this._weights.push(1),this._resetCurveRenderer()}},{key:"_updateKnots",value:function(t,e,i){this._knots=[];var r=0;if(i){for(;e>r;r++)this._knots.push(e-1);for(;t>r;r++)this._knots.push(r);for(var s=r;t+e>r;r++)this._knots.push(s)}else for(;t+e>r;r++)this._knots.push(r);this._dirtyKnots=!1}},{key:"_calculate",value:function(){var t=this._offset/3,e=this._degree;if(this._tempPoint[0]=0,this._tempPoint[1]=0,this._tempPoint[2]=0,e>t)throw new Error("NURBS: n < k");this._dirtyKnots&&this._updateKnots(t,e,this._interpolateEndPoints);for(var i=0;i<=this._iterations;i++){for(var r=i/this._iterations*(t-(e-1))+e-1,s=0,o=0;t>o;o++){var n=this._getWeight(o+1,e,t,r);this._tempPoint[0]+=this._weights[o]*this.points.control[3*o]*n,this._tempPoint[1]+=this._weights[o]*this.points.control[3*o+1]*n,s+=this._weights[o]*n}this._tempPoint[0]/=s,this._tempPoint[1]/=s,this.points.curve.set(this._tempPoint,3*i),this._tempPoint[0]=0,this._tempPoint[1]=0}}},{key:"_getWeight",value:function(t,e,i,r){if(1==e)return r>=this._knots[t-1]&&r<this._knots[t]?1:0;var s=r-this._knots[t-1],o=this._knots[t+e-2]-this._knots[t-1],n=this._knots[t+e-1]-r,a=this._knots[t+e-1]-this._knots[t],u=0,l=0;return o&&(u=s/o*this._getWeight(t,e-1,i,r)),a&&(l=n/a*this._getWeight(t+1,e-1,i,r)),u+l}},{key:"degree",set:function(t){this._dirtyKnots=!0,this._degree=t,this._resetCurveRenderer()}}]),e}(l["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";var r=i(3)["default"],s=i(8)["default"],o=i(1)["default"];Object.defineProperty(e,"__esModule",{value:!0});var n=i(43),a=i(78),u=o(a),l=i(57),c=o(l),d=function(){function t(e,i){var r=(void 0===arguments[2]?[]:arguments[2],void 0===arguments[3]?20:arguments[3]);s(this,t);var o=3*r+3;if(this._camera=i,this._thetas=new Float32Array(o/3),this.points={control:new Float32Array(60),curve:new Float32Array(o)},this.renderers={control:new u["default"](e,new c["default"](e,[.5,.5,0],5)),curve:new u["default"](e,new c["default"](e,[1,1,1],1))},this._iterations=r,this._tempPoint=n.vec3.create(),this._offset=0,this.constructor==t)throw new TypeError("Curve can't be instantiated directly.");if(void 0==this._calculate)throw new TypeError("Curve::_calculate must be declared");if(void 0==this.clear)throw new TypeError("Curve::_clear must be declared");if(void 0==this._reset)throw new TypeError("Curve::_reset must be declared")}return r(t,[{key:"setControlPoints",value:function(t,e){this._reset(t,e)}},{key:"render",value:function(){this.renderers.curve.flush(this._camera),this.renderers.control.flush(this._camera)}},{key:"updateControlPoint",value:function(t,e){this.points.control.set(e,3*t),this.renderers.control.update(t,{coords:e}),this._resetCurveRenderer()}},{key:"intersectsControlPoint",value:function(t){for(var e=void 0===arguments[1]?.01:arguments[1],i=0,r=0,s=0,o=0,n=0;n<this._offset;n+=3)if(r=t[0]-this.points.control[n],s=t[1]-this.points.control[n+1],o=t[2]-this.points.control[n+2],i=r*r+s*s+o*o,e>i)return n/3;return-1}},{key:"_calculateSlopes",value:function(){var t=this.points.curve.length,e=this.points.curve[0],i=this.points.curve[1],r=this.points.curve[3],s=this.points.curve[4];this._thetas[o/3]=Math.atan2(s-i,r-e);for(var o=3;t-3>o;o+=3)r=this.points.curve[o],s=this.points.curve[o+1],this._thetas[o/3]=Math.atan2(s-i,r-e),e=r,i=s;r=this.points.curve[o],s=this.points.curve[o+1],this._thetas[o/3]=Math.atan2(s-i,r-e)}},{key:"_resetCurveRenderer",value:function(){this._calculate(),this.renderers.curve.reset({coords:this.points.curve})}},{key:"_resetControlRenderer",value:function(){this.renderers.control.reset({coords:this.points.control.subarray(0,this._offset)})}},{key:"_appendToControlRenderer",value:function(t){this.points.control.set(t,this._offset),this._offset+=t.length,this.renderers.control.submit({coords:t})}},{key:"iterations",set:function(t){this._iterations=t,this.points.curve=new Float32Array(3*t+3),this._thetas=new Float32Array((3*t+3)/3),this._resetCurveRenderer()}}]),t}();e["default"]=d,t.exports=e["default"]},function(t,e,i){"use strict";var r=i(34)["default"],s=i(37)["default"],o=i(3)["default"],n=i(8)["default"],a=i(1)["default"];Object.defineProperty(e,"__esModule",{value:!0});var u=i(81),l=a(u),c=function(t){function e(t,i){var r=void 0===arguments[2]?[]:arguments[2],o=void 0===arguments[3]?{iterations:20,closed:!1}:arguments[3];n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,i,r,o.iterations),this.closed=o.closed,this._weights=[],this._nodes=[],this._variance=.09,this._dirtyNodes=!0,r.length&&this._init(r)}return r(e,t),o(e,[{key:"clear",value:function(){this._offset=0,this.points.curve=new Float32Array(3*this._iterations+3),this._resetControlRenderer(),this._resetCurveRenderer()}},{key:"_reset",value:function(t,e){this._offset=e,this._dirtyNodes=!0,this._weights=[];for(var i=0;i<this._offset/3;i++)this._weights.push(1);this.points.control=t,this._resetControlRenderer(),this._resetCurveRenderer()}},{key:"_init",value:function(t){this._appendToControlRenderer(t);for(var e=0;e<this._offset/3;e++)this._weights.push(1);this._resetCurveRenderer()}},{key:"_updateNodes",value:function(){var t=this._offset/3;this._nodes=[];for(var e=0;t>e;e++)this._nodes.push(e/t);this._dirtyNodes=!1}},{key:"addControlPoint",value:function(t){this._dirtyNodes=!0,this._appendToControlRenderer(t),this._weights.push(1),this._resetCurveRenderer()}},{key:"_calculate",value:function(){var t=this._offset/3,e=this.closed?this.closed_g.bind(this):this.g.bind(this),i=0;this._dirtyNodes&&this._updateNodes();for(var r=0;r<=this._iterations;r++){i=r/this._iterations;for(var s=0;t>s;s++){var o=e(s,i);this._tempPoint[0]+=this.points.control[3*s]*o,this._tempPoint[1]+=this.points.control[3*s+1]*o}this.points.curve.set(this._tempPoint,3*r),this._tempPoint[0]=0,this._tempPoint[1]=0}}},{key:"g",value:function(t,e){for(var i=this._weights[t],r=this.G(t,e),s=0,o=0;o<this._offset/3;o++)s+=this._weights[o]*this.G(o,e);return i*r/s}},{key:"G",value:function(t,e){return Math.exp(-((e-this._nodes[t])*(e-this._nodes[t]))/this._variance*2)}},{key:"closed_g",value:function(t,e){for(var i=this._weights[t],r=this.closed_G(t,e),s=0,o=0;o<this._offset/3;o++)s+=this._weights[o]*this.closed_G(o,e);return i*r/s}},{key:"closed_G",value:function(t,e){for(var i=0,r=-2;2>r;r++){var s=e-(this._nodes[t]+r);i+=Math.exp(-s*s/this._variance*2)}return i}},{key:"variance",set:function(t){this._variance=t,this._resetCurveRenderer()}}]),e}(l["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function r(){C.update(),N.flush(),F.current.render()}var s=i(1)["default"],o=i(43),n=i(76),a=s(n),u=i(2),l=s(u),c=i(80),d=s(c),h=i(82),f=s(h),_=i(62),v=s(_),m=i(78),p=(s(m),i(63)),g=s(p),y=i(69),w=s(y),M=i(33),b=s(M),P=i(57),x=s(P),k=i(66),A=s(k),S=i(75),R=s(S),C=new l["default"](document.querySelector("#canvas-closed"),{clearColor:[0,.1,0,1]}),j=new g["default"],N=new v["default"](j);j.position=[0,0,1],C.camera=j;var V=new b["default"](C._gl,{geometry:new w["default"](25),material:new x["default"](C._gl,[.3,.3,.3]),drawMode:"LINES"});V.position=[0,0,-1],V.scale=[.1,.1,.1];var E=new b["default"](C._gl,{geometry:new A["default"]([-1,0,0],[1,0,.2]),material:new x["default"](C._gl,[1,0,0]),drawMode:"LINES"}),O=new b["default"](C._gl,{geometry:new A["default"]([0,-1,0],[0,1,.2]),material:new x["default"](C._gl,[0,1,0]),drawMode:"LINES"}),F=a["default"].curves.closed;F.rags=new f["default"](C._gl,j,new Float32Array([-.2,-.2,0,-.2,.2,0,.2,.2,0,.2,-.2,0]),{closed:!0}),F.nurbs=new d["default"](C._gl,j,new Float32Array([-.2,-.2,0,-.2,.2,0,.2,.2,0,.2,-.2,0]));var q=o.vec3.create(),L=-1;C.bindControls({onMouseDown:function(t){return q=o.vec3.create(),j.unproject(t,q),F.edit?void(L=F.current.intersectsControlPoint(q)):(F.current.addControlPoint(q),R["default"].closed.degreeRange.max=F.current._offset/3,void a["default"].notify("closed"))},onMouseMove:function(t){0>L||!F.edit||(j.unproject(t,q),F.current.updateControlPoint(L,q),~L&&a["default"].notify("closed"))},onMouseUp:function(t){F.edit&&(0>L||(j.unproject(t,q),F.current.updateControlPoint(L,q),L=-1,r()))}}),a["default"].register("closed",r),a["default"].register("curveSize",r),F.current=F.rags,N.submit(V,E,O),window.addEventListener("resize",r),r()},function(t,e,i){"use strict";var r=i(1)["default"],s=(i(43),i(76)),o=r(s),n=i(88),a=r(n),u=i(89),l=r(u),c=i(65),d=r(c),h=i(2),f=r(h),_=i(33),v=r(_),m=i(85),p=(r(m),i(69)),g=r(p),y=i(57),w=r(y),M=i(70),b=(r(M),i(62)),P=r(b),x=i(74),k=r(x),A=i(78),S=(r(A),i(90)),R=r(S),C=new f["default"](document.querySelector("#canvas-3d")),j=new a["default"](.01),N=new k["default"],V=new P["default"](N),E=new d["default"](N,1.5);N.position=[0,0,-E.radius],N.at=[0,0,0];var O=new v["default"](C._gl,{material:new w["default"](C._gl,[.3,.3,.3]),geometry:new g["default"](5),drawMode:"LINES"}),F=o["default"].curves.open.current,q=o["default"].curves.closed.current,L=new R["default"](C._gl,F,q);o["default"].register("curvesChanged",function(){F=o["default"].curves.open.current,q=o["default"].curves.closed.current}),o["default"].register("open",function(){L.reset(F,q)}),o["default"].register("closed",function(){L.reset(F,q)}),o["default"].register("curveSize",function(){L.reset_size(F,q)}),O.rotate([1,0,0],Math.PI/2),O.position=[0,0,.1],C.camera=N,V.submit(O),C.bindControls({keys:!0,mouse:!0,interceptRightClick:!0,onMouseUp:function(t){return t.button?void 0:E.stop(t)},onMouseDown:function(t){return t.button?void j.start(t.offsetX,t.offsetY):E.start(t)},onMouseMove:function(t){if(t.buttons){if(1===t.buttons)return E.move(t),void(L.rotation=E.rotation);j.move(t.offsetX,t.offsetY),N.incrementPosition(j._delta[0],j._delta[1])}}});var I=new l["default"](N);document.addEventListener("wheel",function(t){t.deltaY<0?I.goal=N.fov-10:I.goal=N.fov+10}),function T(){window.requestAnimationFrame(T),I.tick(),C.update(),L.render(N),V.flush()}()},function(t,e,i){"use strict";var r=i(8)["default"],s=i(86)["default"],o=i(1)["default"];Object.defineProperty(e,"__esModule",{value:!0});var n=i(55),a=(o(n),function u(){var t=void 0===arguments[0]?[]:arguments[0];void 0===arguments[1]?!0:arguments[1];r(this,u),this.coords=t,this.indices=new Uint16Array(s(t))});e["default"]=a,t.exports=e["default"]},function(t,e,i){t.exports={"default":i(87),__esModule:!0}},function(t,e,i){i(40),t.exports=i(6).core.Object.keys},function(t,e,i){"use strict";var r=i(3)["default"],s=i(8)["default"];Object.defineProperty(e,"__esModule",{value:!0});var o=i(43),n=function(){function t(){var e=void 0===arguments[0]?1:arguments[0];s(this,t),this._start=o.vec3.create(),this._delta=o.vec3.create(),this.sensitivity=e}return r(t,[{key:"start",value:function(t,e){this._start[0]=t,this._start[1]=e}},{key:"move",value:function(t,e){this._delta[0]=this.sensitivity*(t-this._start[0]),this._delta[1]=this.sensitivity*(e-this._start[1]),this._start[0]=t,this._start[1]=e}},{key:"stop",value:function(t,e){}}]),t}();e["default"]=n,t.exports=e["default"]},function(t,e,i){"use strict";var r=i(3)["default"],s=i(8)["default"];Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(e){s(this,t),this._camera=e,this._t=1,this._start=e.fov,this._goal=0}return r(t,[{key:"tick",value:function(){this._t<1&&(this._camera.fov=this._start+this._t*(this._goal-this._start),this._t+=.16,this._t>=1&&(this._start=this._goal))}},{key:"camera",set:function(t){this._camera=t}},{key:"goal",set:function(t){this._t&&this._t<1&&(this._start=this._start+this._t*(this._goal-this._start)),this._goal=t,this._t=0}}]),t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";var r=i(34)["default"],s=i(37)["default"],o=i(3)["default"],n=i(8)["default"],a=i(1)["default"];Object.defineProperty(e,"__esModule",{value:!0});var u=i(43),l=i(70),c=a(l),d=i(78),h=a(d),f=i(42),_=a(f),v=function(t){function e(t,i,r){n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this._renderer=new h["default"](t,new c["default"](t,{ambient:[1,0,0,1],diffuse:[1,0,0,1],specular:[1,0,0,1]}),[t.TRIANGLE_STRIP]),this._openN=0,this._closedN=0,this.coords=null,this.normals=null,this._init(i,r)}return r(e,t),o(e,[{key:"_init",value:function(t,e){this._openN=t.points.curve.length,this._closedN=e.points.curve.length,this.coords=new Float32Array(this._closedN/3*this._openN/3*6),this.normals=new Float32Array(this.coords.length),this._computeSurface(t,e),this._renderer.submit({coords:this.coords,normals:this.normals})}},{key:"_computeSurface",value:function(t,e){t._calculateSlopes();for(var i=new Float32Array(3),r=0,s=0;s<this._openN;s+=3)for(var o=0;o<this._closedN;o+=3)this.coords[r]=t.points.curve[s],this.coords[r+1]=t.points.curve[s+1]+e.points.curve[o+1],this.coords[r+2]=e.points.curve[o],this.coords[r+3]=t.points.curve[s+3],this.coords[r+4]=t.points.curve[s+4]+e.points.curve[o+1],this.coords[r+5]=e.points.curve[o],m(this.coords,t.points.curve,t._thetas[s/3],r,s),m(this.coords,t.points.curve,t._thetas[(s+3)/3],r+3,s+3),r+=6;for(var n=new Float32Array(3),a=new Float32Array(3),s=0;s<this.coords.length;s+=3)n[0]=this.coords[s]-this.coords[s+3],n[1]=this.coords[s+1]-this.coords[s+4],n[2]=this.coords[s+2]-this.coords[s+5],a[0]=this.coords[s+6]-this.coords[s],a[1]=this.coords[s+7]-this.coords[s+1],a[2]=this.coords[s+8]-this.coords[s+2],u.vec3.cross(i,a,n),i[0]+=this.coords[s],i[1]+=this.coords[s+1],i[2]+=this.coords[s+2],this.normals.set(i,s)}},{key:"reset_size",value:function(t,e){this._openN=t.points.curve.length,this._closedN=e.points.curve.length,this.coords=new Float32Array(this._closedN/3*this._openN/3*6),this.normals=new Float32Array(this.coords.length),this._computeSurface(t,e),this._renderer.reset({coords:this.coords,normals:this.normals})}},{key:"reset",value:function(t,e){this._computeSurface(t,e),this._renderer.reset({coords:this.coords,normals:this.normals})}},{key:"render",value:function(t){this._renderer.flush(t,this.modelMatrix,this.normalMatrix)}}]),e}(_["default"]);e["default"]=v;var m=function(){var t=new Float32Array(3),e=new Float32Array(3);return function(i,r,s,o,n){t[0]=i[o]-r[n],t[1]=i[o+1]-r[n+1],t[2]=i[o+2]-r[n+2],e[0]=t[0]*Math.cos(s)-t[1]*Math.sin(s),e[1]=t[0]*Math.sin(s)+t[1]*Math.cos(s),
e[2]=t[2],i[o]=e[0]+r[n],i[o+1]=e[1]+r[n+1],i[o+2]=e[2]+r[n+2]}}();t.exports=e["default"]}]);